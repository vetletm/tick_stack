# Influxdb Configuration
#
# THIS FILE IS MANAGED BY PUPPET
#
# Global settings
[global]
bind-address = "<%= scope['tick_stack::influxdb::bind_addr'] %>"

# Metastore settings
[meta]
dir = "<%= scope['tick_stack::influxdb::meta_dir'] %>"

# Data settings
[data]
dir = "<%= scope['tick_stack::influxdb::data_dir'] %>"
wal-dir = "<%= scope['tick_stack::influxdb::wal_dir'] %>"
trace_logging_enabled = <%= scope['tick_stack::influxdb::trace_logging_enabled'] %>
query_log_enabled = <%= scope['tick_stack::influxdb::query_log_enabled'] %>
cache_max_memory_size = <%= scope['tick_stack::influxdb::cache_max_memory_size'] %>
cache_snapshot_memory_size = <%= scope['tick_stack::influxdb::cache_snapshot_memory_size'] %>
cache_snapshot_write_cold_duration = "<%= scope['tick_stack::influxdb::cache_snapshot_write_cold_duration'] %>"
compact_full_write_cold_duration = "<%= scope['tick_stack::influxdb::compact_full_write_cold_duration'] %>"
max_series_per_database = <%= scope['tick_stack::influxdb::max_series_per_database'] %>
max_values_per_tag = <%= scope['tick_stack::influxdb::max_values_per_tag'] %>

<%# The rest are optional hashes that can be defined if needed, they are undef in params %>
<% if scope['tick_stack::influxdb::http'] -%>
[http]
<%   scope['tick_stack::influxdb::http'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::coordinator'] -%>
[coordinator]
<%   scope['tick_stack::influxdb::coordinator'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::retention'] -%>
[retention]
<%   scope['tick_stack::influxdb::retention'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::shardprecreation'] -%>
[shard-precreation]
<%   scope['tick_stack::influxdb::shardprecreation'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::monitor'] -%>
[monitor]
<%   scope['tick_stack::influxdb::monitor'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::logging'] -%>
[logging]
<%   scope['tick_stack::influxdb::logging'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::subscriber'] -%>
[subscriber]
<%   scope['tick_stack::influxdb::subscriber'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

<% if scope['tick_stack::influxdb::tls'] -%>
[tls]
<%   scope['tick_stack::influxdb::tls'].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>
